#define TS_ZVTXRW_cxx
#include "TS_ZVTXRW.h"


Float_t TS_ZVTXRW::GetMCReweight_trev(float truezvtx, int data_samp, 
				      int mode) {
  //data_samp == 0 ALL
  //data_samp == 1 RH
  //data_samp == 2 LH
  //data_samp == 3 LH1
  //data_samp == 4 LH2


//   double totalrw[100]={0.406713,0.356628,0.389121,0.403357,0.42945,0.453226,0.483921,0.433959,0.451651,0.492513,0.479223,0.518881,0.532189,0.559749,0.606677,0.645605,0.707847,0.771631,0.795776,0.861142,0.975834,0.997274,1.04473,1.02144,1.00241,0.909256,0.856018,0.853199,0.850194,0.826582,0.84467,0.855265,0.874485,0.877032,0.873585,0.903194,0.907184,0.927863,0.933506,0.946731,0.948299,0.967887,0.977229,0.984022,0.988894,0.994878,0.996112,1.00436,1.00781,1.00854,1.01135,1.01117,1.01196,1.01058,1.01117,1.00523,1.00146,0.996756,0.980159,0.970746,0.940815,0.913183,0.896013,0.873331,0.859321,0.857823,0.856538,0.885429,0.876174,0.89049,0.865877,0.894276,0.910226,0.929451,0.995388,0.990625,1.03141,1.05355,1.04981,1.04432,1.04341,1.03006,1.03375,1.06858,1.07149,1.09316,1.12958,1.15206,1.21522,1.25602,1.33,1.38959,1.544,1.5949,1.73884,1.9391,1.95269,2.45121,2.37574,6.49126};
 //  double totalrw[100]={
//     721.759,275.487,137.811,68.9939,37.3776,21.1482,12.7554,0.822097,0.821374,0.876736,0.836093,0.878577,0.860533,0.847842,0.843601,0.80855,0.785975,0.752756,0.68364,0.664795,0.707418,0.725743,0.821442,0.913677,1.02583,1.02147,0.988903,0.954001,0.884159,0.78511,0.731817,0.684024,0.661813,0.652363,0.668615,0.739241,0.806259,0.887185,0.939761,0.981862,0.996653,1.01988,1.02594,1.02586,1.02227,1.01952,1.01232,1.01306,1.01,1.00542,1.00415,1.00112,1.00017,0.998051,0.998592,0.993003,0.989267,0.983336,0.962991,0.945024,0.900306,0.850008,0.803329,0.752861,0.722145,0.722585,0.74618,0.818326,0.873968,0.96765,1.02552,1.13983,1.20843,1.21623,1.20426,1.06437,0.992154,0.9505,0.936761,0.9562,0.995646,1.02316,1.05629,1.10307,1.09378,1.07863,1.05312,0.993584,0.952525,0.884981,0.843064,0.808968,0.86834,12.7728,23.6976,47.3895,90.1763,225.401,458.364,2768.76};

//   double totalrw[100] = {214.816,40.9963,21.4848,9.28943,5.82718,2.69755,1.26545,0.916671,1.29427,0.663122,0.762092,0.801106,0.888917,0.903752,0.902467,0.845461,0.861698,0.697134,0.737805,0.603165,0.653455,0.587591,0.918417,0.837775,0.992841,1.00729,1.13727,0.693779,1.00733,0.72663,0.848435,0.844416,0.630707,0.756627,0.835663,0.922716,1.06314,1.04351,0.964559,0.994014,1.00065,1.01187,1.00303,1.01394,0.983752,1.00701,1.01194,1.01038,1.00788,1.01606,1.02579,1.02496,1.02236,0.991309,0.999236,0.952655,0.952716,0.966463,0.941568,0.923087,0.935007,0.929244,0.85854,0.855867,0.760028,0.704198,0.735748,0.683202,0.592672,0.861609,0.929802,1.17826,1.08018,0.805146,1.0721,0.808259,1.01662,0.983903,1.01006,0.986892,1.00995,1.11896,1.02947,1.09364,1.03085,1.0447,1.1024,1.04851,0.889691,0.812388,0.901098,0.699432,1.10615,1.33309,2.06885,2.76955,2.11756,3.9892,2.71846,49.5456};
  double totalrw[100]={721.759,275.487,137.811,68.9939,37.3776,21.1482,12.7554,0.461377,0.497559,0.5589,0.556877,0.613791,0.637042,0.673995,0.730444,0.772605,0.836911,0.895952,0.902007,0.947403,1.03664,1.01919,1.02668,0.970317,0.931836,0.840187,0.79523,0.799227,0.800981,0.780318,0.797121,0.806524,0.825369,0.831359,0.835515,0.87513,0.891774,0.923622,0.937364,0.95519,0.958462,0.978097,0.986297,0.991391,0.994367,0.998495,0.998028,1.00484,1.00714,1.00706,1.00941,1.00914,1.01017,1.00938,1.01086,1.00604,1.00353,1.00001,0.984192,0.974739,0.9432,0.911861,0.888594,0.858279,0.836799,0.829574,0.82532,0.852387,0.843718,0.856811,0.828735,0.84348,0.833855,0.814819,0.832442,0.803806,0.835165,0.871591,0.89864,0.928628,0.962761,0.982651,1.01468,1.07335,1.09517,1.13036,1.17474,1.19794,1.25598,1.2827,1.33417,1.36116,1.46812,12.7728,23.6976,47.3895,90.1764,225.401,458.364,2768.76};
// double lhrw[200]={1.45216,0.91174,0.529055,0.488826,0.763063,0.611415,0.57676,0.467766,0.624211,0.518741,0.729,0.538165,0.596033,0.657738,0.675486,0.669318,0.747262,0.771216,0.740657,0.863043,0.835987,0.845488,0.880862,0.902547,0.933022,0.950819,0.963747,1.0043,0.982673,1.06224,1.06013,1.04246,1.05438,1.08727,1.06335,1.06253,1.01251,1.09634,1.10312,1.0481,1.04243,1.06234,1.08693,1.00877,1.09717,1.10011,1.0353,1.01626,1.04926,1.05799,1.03561,1.03491,0.930017,0.987543,0.952162,0.939895,0.885164,0.892723,0.908135,0.888187,0.947438,0.830626,0.815746,0.816755,0.817002,0.765189,0.824718,0.802968,0.775754,0.809432,0.782738,0.806433,0.813945,0.843662,0.831284,0.838874,0.882087,0.890849,0.892687,0.905728,0.913229,0.929123,0.93346,0.935662,0.940349,0.946922,0.959541,0.958105,0.968245,0.971546,0.971417,0.981697,0.987873,0.981483,0.989685,0.993601,0.991606,1.00025,1.00104,1.00774,1.0076,1.00403,1.00697,1.01546,1.01956,1.02071,1.01922,1.02248,1.02329,1.02844,1.02718,1.02608,1.02951,1.02462,1.02691,1.01957,1.01594,1.01183,0.990927,0.993365,0.973509,0.961601,0.925011,0.904542,0.889375,0.853201,0.846428,0.815555,0.776654,0.769912,0.750764,0.757672,0.734111,0.773865,0.74407,0.762768,0.778962,0.820041,0.775671,0.787871,0.793678,0.851166,0.85828,0.899515,0.86137,0.924109,1.02785,0.997961,1.09014,1.09819,1.11697,1.19951,1.176,1.34774,1.30845,1.31445,1.43244,1.44895,1.55594,1.52763,1.58522,1.61725,1.64048,1.64288,1.5986,1.67722,1.62103,1.68982,1.58541,1.62839,1.58903,1.62721,1.59778,1.56562,1.63072,1.56151,1.45606,1.40333,1.43336,1.4139,1.41811,1.35211,1.39387,1.22831,1.14481,1.04913,1.01851,1.19483,1.01869,0.87685,0.910813,0.969031,0.951146,0.667692,0.972116,1.65389,1.87535,0.981888,1.1747,0.421015};

double lhrw[100] = {722.159,274.953,137.751,68.993,37.3778,21.152,12.7622,0.572469,0.625158,0.713083,0.720322,0.802836,0.838395,0.888297,0.958601,1.00406,1.07149,1.12491,1.10608,1.13221,1.2075,1.16066,1.15053,1.07714,1.02571,0.90774,0.828265,0.789598,0.744344,0.681712,0.657881,0.634734,0.628057,0.623558,0.632547,0.683745,0.727958,0.787631,0.828517,0.866879,0.886133,0.916353,0.933134,0.945369,0.954679,0.964716,0.970208,0.982971,0.991604,0.998215,1.00766,1.01488,1.02379,1.03116,1.04106,1.04439,1.0497,1.05283,1.04074,1.03143,0.992582,0.946112,0.900119,0.842994,0.798696,0.779763,0.778653,0.822083,0.843648,0.897686,0.91598,0.986781,1.02938,1.04831,1.09405,1.05972,1.09897,1.15111,1.20158,1.26409,1.33619,1.38842,1.4545,1.55334,1.59136,1.6392,1.68957,1.69824,1.74423,1.73436,1.74735,1.71862,1.78219,12.7754,23.6934,47.3723,90.0952,225.505,457.973,2761.56};
 
double lh1rw[100] = {722.159,274.953,137.751,68.993,37.3778,21.152,12.7622,0.4699,0.514437,0.585781,0.589479,0.653952,0.679647,0.716847,0.77048,0.804296,0.856025,0.896957,0.880879,0.901325,0.961834,0.926508,0.922901,0.872156,0.843305,0.761959,0.711919,0.695102,0.670156,0.626303,0.614846,0.600697,0.597732,0.591253,0.591869,0.62819,0.658707,0.708304,0.747749,0.790811,0.820355,0.862264,0.892518,0.918334,0.940565,0.962371,0.978193,0.999724,1.0153,1.02689,1.03938,1.0475,1.05523,1.05922,1.06367,1.05936,1.05519,1.0472,1.02313,1.00171,0.95296,0.900027,0.851898,0.797526,0.757379,0.740008,0.735809,0.768997,0.77738,0.811906,0.810919,0.852837,0.865701,0.854442,0.861038,0.804762,0.808371,0.825392,0.844906,0.875449,0.914082,0.940115,0.976311,1.03496,1.05368,1.07978,1.10837,1.11053,1.13798,1.12973,1.13689,1.11693,1.15604,12.7754,23.6934,47.3723,90.0952,225.505,457.973,2761.56};
 
 double lh2rw[100] = {722.159,274.953,137.751,68.993,37.3778,21.152,12.7622,0.478947,0.559295,0.673822,0.712634,0.825976,0.891995,0.972523,1.07499,1.14813,1.24362,1.31873,1.30265,1.33146,1.40818,1.33251,1.29236,1.18186,1.10623,0.974467,0.895054,0.862522,0.819994,0.753347,0.72549,0.696593,0.687095,0.684606,0.703196,0.7733,0.834393,0.905923,0.946274,0.975552,0.978174,0.99033,0.987183,0.979983,0.971343,0.965469,0.957356,0.958829,0.958731,0.959251,0.965095,0.971434,0.982016,0.993747,1.01048,1.02323,1.03996,1.05604,1.05725,1.06008,1.02914,0.984624,0.934246,0.868347,0.817305,0.799187,0.807832,0.869372,0.910484,0.98534,1.01663,1.1007,1.15012,1.17774,1.25363,1.26316,1.37961,1.52041,1.65462,1.79544,1.9393,2.04359,2.15782,2.31073,2.3629,2.41921,2.46848,2.4464,2.4674,2.39886,2.35175,2.23813,2.22963,12.7754,23.6934,47.3723,90.0952,225.505,457.973,2761.56};

double lhprerw[200]={0.889821,0.52453,0.284823,0.246665,0.363292,0.277563,0.252886,0.200742,0.265453,0.220922,0.313559,0.235284,0.266096,0.3008,0.317075,0.322832,0.370511,0.393057,0.387842,0.463995,0.461021,0.477749,0.509393,0.533474,0.562927,0.584758,0.603318,0.639048,0.634658,0.695338,0.702355,0.698036,0.712609,0.740745,0.729398,0.733024,0.701885,0.763151,0.770755,0.73507,0.734228,0.752302,0.775263,0.726472,0.800118,0.814915,0.781131,0.782426,0.824781,0.848416,0.845606,0.858237,0.781151,0.837935,0.814329,0.808732,0.765161,0.774376,0.789742,0.773717,0.826084,0.724264,0.710594,0.709899,0.707479,0.658988,0.704981,0.679921,0.649522,0.66932,0.639054,0.650675,0.650449,0.669885,0.658328,0.665196,0.702906,0.71558,0.724562,0.744172,0.760478,0.784769,0.800015,0.81378,0.829897,0.847799,0.871232,0.881836,0.902929,0.917477,0.92845,0.949072,0.965458,0.969083,0.986629,0.999486,1.00586,1.02252,1.03062,1.04426,1.05021,1.05193,1.0598,1.07291,1.08073,1.08475,1.08525,1.09008,1.09159,1.09698,1.09478,1.09199,1.09325,1.08489,1.08336,1.0709,1.06159,1.05105,1.02248,1.01741,0.989015,0.968444,0.923113,0.894295,0.871241,0.828585,0.815687,0.780935,0.740126,0.731385,0.712002,0.718202,0.696099,0.734374,0.706762,0.725128,0.740911,0.779985,0.737216,0.7474,0.75027,0.799923,0.799261,0.826289,0.77593,0.810534,0.870995,0.811155,0.845679,0.812128,0.790116,0.817699,0.780264,0.87946,0.847717,0.852021,0.934259,0.954599,1.03797,1.03323,1.08756,1.1253,1.15705,1.17354,1.15526,1.22476,1.19453,1.25483,1.18465,1.22256,1.19687,1.22771,1.20568,1.17976,1.22518,1.16791,1.08245,1.03533,1.04787,1.0227,1.01339,0.953204,0.968066,0.839326,0.76874,0.691588,0.658564,0.757412,0.633031,0.534442,0.545258,0.571245,0.55442,0.387192,0.565561,0.975764,1.13615,0.618784,0.778726,0.295711};

double lhpostrw[200]={3.61221,2.17355,1.20737,1.06825,1.59954,1.23269,1.122,0.880949,1.14168,0.923995,1.26764,0.915396,0.993373,1.07558,1.08504,1.05711,1.16136,1.18026,1.11684,1.28295,1.22573,1.22324,1.25808,1.27302,1.30014,1.30945,1.31223,1.35246,1.30932,1.40089,1.38438,1.34849,1.35167,1.38199,1.34079,1.32982,1.2586,1.35453,1.3557,1.2824,1.27109,1.29226,1.32035,1.22487,1.33254,1.33685,1.25848,1.23468,1.27235,1.27831,1.24454,1.235,1.10062,1.1579,1.10545,1.08019,1.007,1.00553,1.01317,0.982111,1.03922,0.904806,0.883776,0.881706,0.880812,0.826045,0.894074,0.876731,0.855294,0.902815,0.883864,0.9214,0.939307,0.980675,0.970144,0.979627,1.02756,1.03247,1.02713,1.03294,1.03113,1.03787,1.03112,1.02189,1.01544,1.01119,1.01358,1.00149,1.00195,0.995784,0.986674,0.988672,0.987036,0.973482,0.97503,0.972917,0.965643,0.969336,0.966002,0.968979,0.965986,0.960339,0.961537,0.968657,0.972195,0.973553,0.973021,0.977652,0.98059,0.988329,0.990565,0.993583,1.00165,1.00225,1.01051,1.00989,1.01348,1.01714,1.00428,1.01542,1.00404,1.0009,0.971803,0.959153,0.9517,0.921076,0.921509,0.895083,0.85903,0.858093,0.843221,0.8578,0.83816,0.891521,0.865451,0.896288,0.925241,0.985148,0.942989,0.969788,0.989655,1.0757,1.09985,1.16915,1.13558,1.23515,1.39124,1.36532,1.50352,1.52227,1.55145,1.66521,1.62863,1.85979,1.7981,1.79865,1.95209,1.9672,2.10542,2.06116,2.13367,2.17248,2.20026,2.20095,2.13998,2.24434,2.16905,2.26178,2.12336,2.18302,2.13299,2.18774,2.1523,2.11372,2.20729,2.11978,1.98308,1.91821,1.96714,1.94904,1.96444,1.88315,1.95295,1.73247,1.62678,1.50343,1.47367,1.74815,1.51003,1.32015,1.39725,1.52103,1.53572,1.11634,1.69664,3.04104,3.66806,2.06114,2.66378,1.03411};

 double rhrw[100]={721.46,275.863,137.851,68.9932,37.3768,21.145,12.7503,0.339219,0.369799,0.419784,0.422759,0.470648,0.493454,0.527117,0.576725,0.615678,0.672843,0.726341,0.737225,0.780279,0.860181,0.852665,0.867992,0.833871,0.821669,0.767591,0.756448,0.790738,0.820769,0.824051,0.863575,0.892217,0.927523,0.942935,0.948667,0.98618,0.991041,1.00986,1.00948,1.01592,1.00958,1.02243,1.02468,1.02451,1.02266,1.02223,1.0172,1.01952,1.01718,1.01234,1.00978,1.00445,1.0003,0.99421,0.990274,0.980212,0.972557,0.964395,0.945338,0.934134,0.904641,0.879216,0.865862,0.848663,0.839757,0.841017,0.839274,0.863208,0.845804,0.845566,0.800703,0.791901,0.75295,0.69895,0.672217,0.613156,0.611377,0.62374,0.636633,0.655661,0.679578,0.694251,0.717769,0.760291,0.776675,0.802494,0.834783,0.851872,0.893588,0.913028,0.949752,0.969009,1.04484,12.7706,23.7001,47.4006,90.2324,225.324,458.63,2773.85};
// double rhrw[200]={0.496088,0.355165,0.232368,0.238612,0.4076,0.352088,0.353289,0.301324,0.418925,0.359982,0.519972,0.392664,0.443183,0.496876,0.517146,0.518246,0.584153,0.607757,0.587625,0.688546,0.669966,0.679959,0.710236,0.728958,0.754217,0.76864,0.778516,0.810061,0.790838,0.852346,0.847543,0.829817,0.835161,0.856476,0.832628,0.826715,0.782659,0.842009,0.842133,0.796086,0.789079,0.803449,0.824297,0.770778,0.849522,0.868691,0.838896,0.849326,0.907382,0.947781,0.960243,0.991049,0.917158,0.999913,0.987098,0.995247,0.955476,0.980772,1.01415,1.00717,1.08995,0.968644,0.963526,0.97626,0.987211,0.933495,1.01416,0.993334,0.96312,1.00583,0.970751,0.995428,0.99756,1.02473,0.99944,0.99773,1.03777,1.03701,1.02869,1.03383,1.03315,1.04243,1.03916,1.03399,1.03197,1.03231,1.03942,1.03149,1.03617,1.03363,1.02756,1.03256,1.03324,1.02085,1.0237,1.0221,1.01447,1.01773,1.01298,1.01421,1.00857,0.999569,0.997094,1.00013,0.998842,0.994732,0.988159,0.986314,0.982261,0.982546,0.976951,0.971836,0.97141,0.963636,0.963256,0.954634,0.950479,0.947093,0.929439,0.935416,0.922415,0.91914,0.894415,0.887249,0.88722,0.867273,0.87747,0.861863,0.835116,0.839749,0.827345,0.839979,0.815298,0.857666,0.820216,0.834007,0.842874,0.876403,0.817336,0.817083,0.808523,0.849711,0.837125,0.853899,0.792036,0.818451,0.871589,0.805845,0.835189,0.797626,0.771011,0.791058,0.746084,0.828478,0.784429,0.772641,0.828912,0.827839,0.87941,0.855177,0.87956,0.889662,0.894755,0.888275,0.856554,0.890228,0.851899,0.87881,0.815463,0.82789,0.798052,0.806772,0.781546,0.75504,0.774859,0.730563,0.670292,0.63521,0.637506,0.617459,0.607641,0.568027,0.57367,0.494852,0.451083,0.403927,0.382775,0.437816,0.363459,0.304149,0.306554,0.31572,0.299086,0.201859,0.281186,0.45491,0.486873,0.238555,0.26468,0.0872437};



double eminustotalrw[200]={0.491221,0.615068,0.79173,0.72434,0.961465,0.675159,1.15203,0.976289,0.912402,1.30839,0.968193,1.30382,0.981295,1.66098,1.33665,1.45619,1.42927,1.88169,1.64917,1.86733,1.66795,2.14391,2.14452,2.17942,1.98851,2.10415,2.12609,2.08356,1.93751,2.03908,1.70254,2.06284,1.82955,1.75418,1.72663,1.58034,1.66886,1.4613,1.23319,1.25891,1.20283,1.20205,1.19115,1.16081,1.08657,1.08029,1.03488,1.13496,1.02881,0.997185,1.12247,1.08404,1.07958,1.15486,1.14217,1.15863,1.04781,1.22142,1.12011,1.20721,1.07067,1.18222,1.06589,1.10844,1.04152,1.17928,0.958413,1.12729,0.970973,1.12767,0.973291,1.20021,0.949846,1.10063,0.93013,1.12204,0.957007,1.09813,0.927114,1.09705,0.926465,1.09604,0.935588,1.08426,0.937083,1.06794,0.941543,1.06535,0.945477,1.05399,0.96553,1.04165,0.978276,1.0302,0.978624,1.02009,0.989111,1.00564,0.99817,0.994873,1.00831,0.979612,1.01276,0.976458,1.01829,0.970753,1.02821,0.951777,1.04716,0.938474,1.04558,0.929445,1.05151,0.932739,1.06616,0.915059,1.0888,0.917983,1.06453,0.898044,1.06642,0.892387,1.07907,0.894968,1.06152,0.894695,1.04338,0.918299,1.03949,0.890253,0.958044,0.901505,0.938249,0.869958,0.980883,0.897146,0.961331,0.89434,0.891579,0.833247,0.894439,0.819254,0.853526,0.795068,0.881708,0.786163,0.794661,0.819627,0.811868,0.8225,0.796998,0.815761,0.834277,0.767269,0.846787,0.949991,0.940373,0.911628,1.00661,1.07893,1.06515,1.18645,1.14579,1.16643,1.16973,1.26604,1.29118,1.17865,1.36397,1.23544,1.22157,1.17295,1.21206,1.03141,1.13226,1.00869,1.07875,0.970394,0.881197,0.778024,0.806408,0.794611,0.712514,0.648504,0.63943,0.542548,0.540568,0.449899,0.421539,0.337702,0.410838,0.265657,0.228614,0.258624,0.2588,0.189245,0.234845,0.153843,0.181959,0.111008};
double eminuslhrw[200]={0.6015,0.739151,0.935253,0.84261,1.10351,0.765984,1.29421,1.08776,1.0096,1.43951,1.06015,1.42196,1.06658,1.80006,1.44482,1.57032,1.53788,2.02035,1.76693,1.99635,1.77923,2.28165,2.27678,2.30797,2.10022,2.21625,2.23302,2.18205,2.02322,2.12321,1.76791,2.13658,1.89064,1.80934,1.7785,1.62666,1.71791,1.50574,1.27324,1.30379,1.25086,1.2564,1.25229,1.22809,1.15693,1.15731,1.11476,1.22815,1.11711,1.08517,1.22274,1.18073,1.17455,1.25399,1.23697,1.25087,1.12732,1.30927,1.19618,1.28443,1.13512,1.24929,1.12311,1.1651,1.0927,1.2356,1.00344,1.17998,1.01652,1.18102,1.01979,1.25795,0.995578,1.15323,0.973838,1.17336,0.999178,1.14428,0.963908,1.13776,0.958307,1.13059,0.962342,1.11208,0.958386,1.08914,0.957587,1.0806,0.956526,1.06366,0.972079,1.04636,0.980627,1.03064,0.977248,1.01694,0.984543,0.999611,0.990973,0.986642,0.999057,0.969892,1.00211,0.965774,1.00687,0.959746,1.01658,0.941186,1.03585,0.928772,1.03539,0.92106,1.0429,0.925973,1.05951,0.910338,1.0844,0.915298,1.06258,0.897305,1.0665,0.893092,1.08046,0.896331,1.06308,0.895699,1.04393,0.918067,1.03836,0.888606,0.955765,0.899217,0.936161,0.868756,0.980891,0.898869,0.965466,0.90067,0.900639,0.844458,0.909506,0.835805,0.873484,0.815907,0.906828,0.809748,0.818906,0.844054,0.83436,0.842341,0.812207,0.82616,0.838791,0.765322,0.837756,0.932364,0.916062,0.882177,0.968595,1.03343,1.01665,1.1296,1.08916,1.10791,1.11093,1.20296,1.22799,1.12239,1.30087,1.18033,1.16924,1.12486,1.16463,0.992953,1.0921,0.974676,1.04419,0.940858,0.855722,0.756671,0.785423,0.775053,0.696005,0.634471,0.626678,0.532788,0.532101,0.444131,0.417626,0.336066,0.411144,0.26772,0.232395,0.265711,0.269333,0.199982,0.25263,0.168884,0.204289,0.127682};
double eminusrhrw[200]={0.323714,0.42352,0.56607,0.534632,0.728807,0.523239,0.909331,0.782415,0.740517,1.07322,0.80134,1.08752,0.824076,1.40337,1.13566,1.24367,1.22676,1.62286,1.42905,1.6257,1.45894,1.8841,1.89357,1.93354,1.77256,1.88454,1.91311,1.88344,1.75917,1.85915,1.55832,1.89463,1.68528,1.61949,1.59634,1.46177,1.5426,1.34809,1.13381,1.15183,1.09356,1.08448,1.06528,1.02841,0.953482,0.939376,0.892652,0.972601,0.877549,0.848386,0.954499,0.923146,0.922246,0.991064,0.985773,1.00652,0.916738,1.07661,0.994811,1.08026,0.965085,1.07304,0.973672,1.01838,0.961694,1.09343,0.891593,1.05131,0.907149,1.05486,0.911308,1.12474,0.890975,1.0337,0.874991,1.05769,0.904347,1.04066,0.881385,1.04652,0.886987,1.05327,0.902499,1.04992,0.910851,1.04192,0.921961,1.04688,0.932242,1.04261,0.958048,1.03658,0.976164,1.03058,0.98126,1.02501,0.99579,1.01416,1.00813,1.00609,1.02077,0.992558,1.02679,0.990412,1.03306,0.984837,1.04292,0.965008,1.06109,0.950228,1.05768,0.939175,1.06122,0.940092,1.07304,0.919625,1.09264,0.919928,1.06542,0.897806,1.06525,0.890979,1.0773,0.893867,1.06118,0.895647,1.04634,0.922748,1.04663,0.897955,0.967567,0.910981,0.947829,0.877755,0.987522,0.900464,0.961202,0.890239,0.883113,0.821008,0.87657,0.798639,0.827905,0.767803,0.848461,0.754741,0.762259,0.786963,0.78183,0.796075,0.776827,0.802065,0.828455,0.770027,0.858949,0.973542,0.97276,0.950827,1.05723,1.13961,1.13,1.26276,1.22214,1.24575,1.24989,1.35258,1.37847,1.25688,1.45229,1.31307,1.29568,1.24135,1.27973,1.08632,1.18953,1.05697,1.12742,1.01148,0.916031,0.806566,0.833648,0.819069,0.73221,0.664262,0.652642,0.551564,0.547065,0.452905,0.421695,0.335272,0.404117,0.258343,0.219203,0.243682,0.238647,0.169952,0.204226,0.128713,0.145431,0.0841341};
double highy[200]={0.0105825,0.0146728,0.0243572,0.0315436,0.0456446,0.0612368,0.0603003,0.0964708,0.120827,0.159775,0.174168,0.242142,0.336671,0.357359,0.46734,0.61576,0.588205,0.807642,0.690257,1.08653,1.01679,1.14255,1.15179,1.36134,1.27975,1.82983,1.49369,1.64806,1.86821,1.90249,1.69374,1.68294,1.61827,1.79477,1.55912,1.54038,1.3479,1.27552,1.09337,0.997852,0.859008,0.729515,0.726226,0.596335,0.54472,0.520415,0.428586,0.413914,0.389808,0.359982,0.342529,0.36584,0.391467,0.369553,0.401902,0.405767,0.384305,0.426107,0.44216,0.491977,0.492808,0.497539,0.528675,0.547814,0.544733,0.582608,0.547178,0.615061,0.554872,0.618486,0.626724,0.736579,0.641817,0.729322,0.64484,0.781654,0.706942,0.854033,0.740311,0.898257,0.790953,0.951423,0.852372,1.0078,0.914501,1.07587,0.961653,1.10967,1.019,1.14586,1.06424,1.17687,1.10186,1.19526,1.11969,1.19354,1.13833,1.17108,1.13966,1.14023,1.12611,1.09944,1.10243,1.05795,1.06084,1.00354,1.01118,0.928913,0.960181,0.856755,0.907275,0.787487,0.843772,0.716166,0.780483,0.65636,0.717529,0.583783,0.659058,0.542868,0.615088,0.504095,0.575231,0.479004,0.594682,0.468429,0.597047,0.489981,0.607242,0.528071,0.61707,0.553741,0.670025,0.581847,0.705562,0.584445,0.677037,0.643025,0.617679,0.595466,0.626842,0.592908,0.586511,0.553159,0.613377,0.494871,0.585078,0.551136,0.627657,0.66715,0.674392,0.790434,0.868807,1.02226,1.1718,1.20703,1.55506,1.57112,1.94061,2.52737,2.62616,2.70807,3.30896,3.10885,4.08566,3.53503,4.11691,4.24394,3.8681,3.8382,4.11413,3.31719,3.61692,3.25681,3.6984,2.9241,2.55791,2.36249,2.36943,1.79424,2.27063,1.60111,1.45011,1.23252,0.931835,0.611691,0.754461,0.432928,0.418782,0.272697,0.228684,0.156004,0.125529,0.0915856,0.0872433,0.0580669,0.0413033,0.0223686,0.0198246,0.0101957};

 float totalrw7[100]={
   624151,384432,158180,67824.2,37544.6,19474.5,12278,0.481203,
   0.559527,0.623768,0.677011,0.738802,0.76222,0.783631,0.841701,
   0.879711,0.90578,0.913086,0.877553,0.842054,0.895637,0.860252,
   0.84841,0.851783,0.892217,0.911905,0.884286,0.831027,0.807785,
   0.737765,0.701901,0.665329,0.655596,0.720757,0.780124,0.872415,
   0.925202,0.984604,0.988558,0.989693,0.972657,0.969454,0.977564,
   0.973811,0.980238,0.98819,0.998117,1.00432,1.01177,1.01696,
   1.01875,1.01425,1.01131,1.00595,1.00019,0.989899,0.981326,0.982454,
   0.968802,0.980023,0.971984,0.971669,0.92768,0.866725,0.815413,
   0.773546,0.733433,0.755722,0.824014,0.880657,0.987415,1.10724,
   1.1377,1.13768,1.09772,1.00352,0.900537,0.932649,0.934068,
   0.977338,1.04258,1.10258,1.13072,1.23049,1.22332,1.23978,
   1.29854,1.25278,1.25042,1.21492,1.1368,1.09347,1.05019,12550.6,
   24122,46253.8,102122,209977,476693,3.06554e+06
};
 float lhrw7[100]={
   623192,384081,157944,67621.7,37502,19444.4,12273.4,0.605926,
   0.69872,0.773134,0.834238,0.906286,0.931524,0.955551,1.02543,
   1.07179,1.10402,1.11364,1.0692,1.02177,1.07616,1.01225,0.964542,
   0.926564,0.931574,0.925797,0.881655,0.814169,0.772414,0.679025,
   0.613404,0.54883,0.516979,0.561343,0.620786,0.722731,0.798231,
   0.877031,0.898984,0.911194,0.901723,0.903387,0.915775,0.918134,
   0.931444,0.94739,0.966049,0.981455,0.998043,1.01198,1.02197,
   1.02485,1.02861,1.02942,1.02958,1.02518,1.02298,1.03124,1.02358,
   1.04026,1.03089,1.02054,0.951919,0.855997,0.767779,0.698338,
   0.651801,0.685162,0.78081,0.875342,1.02276,1.18168,1.24221,
   1.27247,1.27013,1.21943,1.15589,1.25206,1.28952,1.36783,1.46643,
   1.55204,1.58921,1.72723,1.71484,1.73732,1.82168,1.76049,1.76397,
   1.72137,1.62022,1.57028,1.52128,12585.8,24166.4,46283.2,102275,
   210483,476657,3.06763e+06
 };
 float rhrw7[100]={
  529634,417086,152657,69853.6,35742.9,19498.8,12027.9,0.370665,
  0.454727,0.528319,0.609651,0.670219,0.700104,0.729931,0.783226,
  0.798662,0.796292,0.773978,0.71697,0.655612,0.682717,0.640237,
  0.615984,0.628354,0.638514,0.639575,0.639158,0.631201,0.680594,
  0.717698,0.784875,0.831683,0.871511,0.945171,0.96612,0.990118,
  0.987309,1.00905,1.01396,1.02172,1.01691,1.02174,1.03298,1.02641,
  1.02485,1.02162,1.02214,1.01771,1.01537,1.01425,1.00914,1.00111,
  0.997546,0.992471,0.987838,0.975729,0.96324,0.955545,0.929318,
  0.918233,0.888292,0.871208,0.836113,0.815515,0.808829,0.817972,
  0.806013,0.814959,0.846857,0.83381,0.901513,0.991126,1.0832,
  1.14328,1.15367,1.09048,0.910865,0.835431,0.746123,0.713569,
  0.721499,0.747421,0.777855,0.847465,0.851718,0.881663,0.910258,
  0.87942,0.860314,0.821027,0.728341,0.660022,0.592906,12560.8,
  23731,44814.5,95638.6,209479,438879,2.46138e+06
};
 float lh1rw7[100]={
   623715,384241,158066,67670.3,37520.4,19446.5,12279.6,0.368963,
   0.44745,0.517495,0.579877,0.650166,0.685484,0.716956,0.779755,
   0.821549,0.848811,0.85554,0.819493,0.782878,0.831133,0.801441,
   0.800336,0.816696,0.86239,0.872923,0.822338,0.74037,0.684305,
   0.592481,0.537053,0.491514,0.477169,0.527135,0.579171,0.659374,
   0.711787,0.772145,0.792384,0.813788,0.82217,0.843228,0.874323,
   0.893924,0.921449,0.948867,0.976563,0.998951,1.02091,1.03886,
   1.05162,1.05599,1.05997,1.05935,1.05603,1.04553,1.03444,1.03114,
   1.01011,1.01333,0.995018,0.983514,0.925367,0.845823,0.769209,
   0.695512,0.624455,0.616403,0.661656,0.716288,0.830828,0.972128,
   1.04144,1.07741,1.05831,0.966312,0.8546,0.872987,0.87001,0.913411,
   0.981369,1.0455,1.07708,1.17396,1.16347,1.17017,1.21101,1.14817,
   1.12164,1.06073,0.961277,0.891546,0.82133,12582,24155,46275.9,
   102223,210555,477333,3.07825e+06
 };
 float lh2rw7[100]={
   622422,383841,157763,67552,37474.4,19441,12264.2,0.544411,
   0.669279,0.787977,0.899556,1.02514,1.09455,1.15407,1.25965,
   1.3245,1.3584,1.35085,1.26696,1.17376,1.19096,1.07357,0.976764,
   0.89498,0.863514,0.837216,0.798509,0.760505,0.765674,0.729331,
   0.718079,0.687427,0.660681,0.689583,0.707476,0.770158,0.823287,
   0.905551,0.946199,0.980197,0.984154,0.988995,0.994274,0.979902,
   0.971747,0.96401,0.959449,0.954262,0.954494,0.957514,0.962812,
   0.967532,0.978975,0.992592,1.00904,1.02217,1.03552,1.05378,
   1.04626,1.05161,1.01969,0.983679,0.902779,0.822194,0.778368,
   0.768637,0.769643,0.828009,0.923018,0.993722,1.12651,1.29669,
   1.40402,1.52188,1.62141,1.63683,1.58931,1.73384,1.79728,1.9294,
   2.10358,2.26621,2.35501,2.58271,2.56753,2.58205,2.66258,2.50672,
   2.42558,2.26787,2.03504,1.87732,1.74076,12591.6,24183,46294.6,
   102351,210387,475685,3.05265e+06
 };
 float totalrw8[100]={
   722159,274953,137751,68993,37377.8,21152,12762.2,0.595325,0.69035,
   0.823003,0.858444,0.978162,1.03519,1.10247,1.18636,1.22913,1.2865,
   1.31279,1.24257,1.21266,1.22414,1.11522,1.07011,1.01866,1.04777,
   1.03278,1.03125,1.02613,0.957242,0.828331,0.732254,0.644352,0.602501,
   0.607401,0.669568,0.800779,0.914034,1.01069,1.04543,1.05241,1.02704,
   1.01509,0.993558,0.974496,0.959379,0.950763,0.942482,0.946181,0.952557,
   0.965564,0.987757,1.00534,1.0115,1.00088,0.987056,0.974862,0.98044,
   1.0011,1.0219,1.05574,1.06084,1.04398,0.995991,0.894054,0.777974,
   0.693846,0.666859,0.734341,0.832631,0.994029,1.11886,1.28437,1.37015,
   1.37652,1.39729,1.3421,1.43105,1.57596,1.73024,1.89301,2.05231,
   2.1595,2.26595,2.40117,2.42063,2.43493,2.43332,2.35475,2.31226,2.18238,
   2.07113,1.90258,1.82415,12775.4,23693.4,47372.3,
   90095.2,225505,457973,2.76156e+06
 };
    if (fabs(truezvtx)<85.0) {
      // if (beamcharge >0){
// 	cout << "truezvtx "<<truezvtx<<" "<<(int)(truezvtx/2.+100)<<"\n";
// 	if (beamcharge==2) return (lhprerw[(int)(truezvtx+100)]);
// 	if (beamcharge==3) return (lhpostrw[(int)(truezvtx+100)]);
// 	if (polsign==0) return (totalrw[(int)(truezvtx/2.+50)]);
// 	if (polsign==-1) return (lhrw[(int)(truezvtx/2.+50)]);
// 	if (polsign==1) return (rhrw[(int)(truezvtx/2.+50)]);
// 	if (polsign>1 || polsign<-1) return (highy[(int)(truezvtx+100)]);
//       }
//       if (beamcharge <0){
// 	if (polsign==0) return (eminustotalrw[(int)(truezvtx+100)]);
// 	if (polsign==-1) return (eminuslhrw[(int)(truezvtx+100)]);
// 	if (polsign==1) return (eminusrhrw[(int)(truezvtx+100)]);
//       }
      if(mode == 0) {
	if(data_samp == 0)
	  return (totalrw[(int)(truezvtx/2.+50)]);
	else if(data_samp == 1)
	  return (rhrw[(int)(truezvtx/2.+50)]);
	else if(data_samp == 2)
	  return (lhrw[(int)(truezvtx/2.+50)]);
	else if(data_samp == 3)
	  return (lh1rw[(int)(truezvtx/2.+50)]);
	else if(data_samp == 4)
	  return (lh2rw[(int)(truezvtx/2.+50)]);
      }
      else if(mode == 1) {
	if(data_samp == 0)
          return (totalrw7[(int)(truezvtx/2.+50)]);
        else if(data_samp == 1)
          return (rhrw7[(int)(truezvtx/2.+50)]);
        else if(data_samp == 2)
          return (lhrw7[(int)(truezvtx/2.+50)]);
        else if(data_samp == 3)
          return (lh1rw7[(int)(truezvtx/2.+50)]);
        else if(data_samp == 4)
          return (lh2rw7[(int)(truezvtx/2.+50)]);
      }
      else if(mode == 2) {
	if(data_samp == 0)
          return (totalrw8[(int)(truezvtx/2.+50)]);
      }
    } else {
      return 1.0;
    }
    
    
}
